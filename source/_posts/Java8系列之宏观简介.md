---
title: Java8系列之宏观简介
tags:
  - Java8系列
abbrlink: c4dacfdd
date: 2017-12-20 14:15:41
---

### 简介：

- 速度更快
- 代码更少
- 强大的Stream API
- 便于并行
- 最大化减少空指针异常

> 其中最为核心的是Lambda 表达式与Stream API

## Java8的代码执行速度更快的几个原因：

###   1. 底层数据结构的优化：

- HashMap的优化：

碰撞的个数大于8，总大小大于64，把每个链表转变成**红黑树 **。

除了添加操作以外，其他的效率都变高，

添加的时候1.7 是加在链表的头部，1.8是加在链表的尾部。

效率高的原因是：每次判断都是只判断一半。

扩容之后再重新排序，不会再去运算每个每个元素的hashcode值了，直接是原来hash表的长度加上现在的位置。

<br/>

- ConcurrentHashMap的优化

取消了用16个段来提升并发性的方式，采用了CAS算法。

添加元素的时候，采用的是无锁算法(CAS)。

{% asset_img aa.png %}

casTabAt方法： 调用底层的CAS算法的实现。

{% asset_img bb.png %}
<br/>

### 2.底层的内存结构的优化

- 栈：局部变量，对象的引用。
- 堆：对象的实体，成员变量。
- 永久区(  方法区也被包含在永久区当中，永久区当中就存储一些类信息，核心类库都被加载到永久区当中 ，永久区中的内容几乎不会被垃圾回收，会被回收，但是回收的条件比较苛刻)。
- 1.8以后，永久区被删除，用MetaSpace 元空间取代。
- MetaSpace 直接使用的是物理内存。

{% asset_img cc.png %}

<br/>

### 3.注解的变化

两点改进：可重复注解和可用于类型的注解

<br/>

### 4.接口变化

- 接口中允许存在已经实现的方法
- 继承的类和实现的接口有同样的方法的时候，类优先原则
- 当实现的两个类具有同样的方法的实现的时候，需要明确执行出来使用哪个。

