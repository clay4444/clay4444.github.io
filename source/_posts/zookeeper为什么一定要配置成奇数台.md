---
title: zookeeper为什么一定要配置成奇数台
tags:
  - zookeeper
categories:
  - big-data
abbrlink: ce3cc54d
date: 2018-06-03 20:49:31
---

#### 选举机制(FastLeaderElection算法)：

sid最小且被超过集群中超过半数的机器拥护就会成为leader.

<br/>

所以只有两种情况无法选出leader：

整个集群只有2台服务器（注意不是只剩2台，而是集群的总节点数为2）

整个集群超过半数机器挂掉。

<br/>

所谓的偶数问题其实是另一个***集群优化配置***问题，即:**集群的容灾数量=集群总节点数/2-1**

<br/>

假如集群有5节点，那么最多允许2个节点挂掉，如果有3节点挂了，那么整个集群的选举结果不会满足条件：集群中超过半数的机器拥护。

假如集群有6个节点，那么最多也只能挂掉2台，因为挂了3台时，选举结果也不会满足条件:集群中超过半数的机器拥护。

<br/>

结果可以看出，多那一台用处并不大。所以集群总数推荐为奇数。

<br/>